<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Teams SSO Auth</title>
  <script src="https://statics.teams.cdn.office.net/sdk/v1.13.0/js/MicrosoftTeams.min.js"></script>
</head>
<body>
  <p>Loading authentication...</p>

  <script>
    console.log("üëã auth.html loaded");

    microsoftTeams.app.initialize().then(() => {
      console.log("‚úÖ Teams SDK initialized in auth.html");

      microsoftTeams.authentication.getAuthToken({
        successCallback: (token) => {
          console.log("‚úÖ Token acquired in auth.html");
          microsoftTeams.authentication.notifySuccess(token);
        },
        failureCallback: (err) => {
          console.error("‚ùå Auth failed in auth.html:", err);
          microsoftTeams.authentication.notifyFailure(err);
        }
      });
    }).catch(err => {
      console.error("‚ùå Teams SDK init failed in auth.html:", err);
      microsoftTeams.authentication.notifyFailure(err.toString());
    });
  </script>
</body>
</html>
