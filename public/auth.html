<!DOCTYPE html>
<html>
<head>
  <title>Authenticating...</title>
  <script src="https://statics.teams.cdn.office.net/sdk/v1.13.0/js/MicrosoftTeams.min.js"></script>
</head>
<body>
  <div id="log" style="font-family: monospace;"></div>

  <script>
    const log = (msg) => {
      document.getElementById("log").innerHTML += msg + "<br>";
      console.log(msg);
    };

    log("üì¶ Page loaded");

    microsoftTeams.app.initialize().then(() => {
      log("‚úÖ Teams SDK initialized");

      microsoftTeams.authentication.getAuthToken({
        resources: ["https://graph.microsoft.com"],
        successCallback: function (token) {
          log("‚úÖ Token acquired");
          microsoftTeams.authentication.notifySuccess(token);
        },
        failureCallback: function (error) {
          log("‚ùå Auth failed: " + error);
          microsoftTeams.authentication.notifyFailure(error);
        }
      });
    }).catch(err => {
      log("‚ùå Teams SDK init failed: " + err.message);
    });
  </script>
</body>
</html>
